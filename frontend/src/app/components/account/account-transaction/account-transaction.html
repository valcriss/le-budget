<div
  (dblclick)="onDoubleClick()"
  class="flex flex-row px-2 h-8 text-xs text-gray-500 border-b border-gray-100">
  <div class="basis-0 flex items-center"><app-checkbox></app-checkbox></div>
  <!-- Read mode -->
  <ng-container *ngIf="!editing">
    <div class="basis-6/12 md:basis-2/12 flex items-center px-1">
      {{ formatDisplayDate(transaction.date) }}
    </div>
    <div class="basis-3/12 md:basis-2/12 flex items-center px-1">{{ transaction.label }}</div>
    <div class="hidden basis-3/12 md:basis-2/12 md:flex items-center px-1">
      {{ transaction.categoryName || 'â€”' }}
    </div>
    <div
      class="hidden basis-3/12 md:basis-2/12 md:flex items-center justify-end px-1 text-right"
      [class]="getAmountClass(debitAmount(transaction))"
    >
      {{ formatCurrencyWithSign(debitAmount(transaction), false, true) }}
    </div>
    <div
      class="hidden basis-3/12 md:basis-2/12 md:flex items-center justify-end px-1 text-right"
      [class]="getAmountClass(creditAmount(transaction))"
    >
      {{ formatCurrencyWithSign(creditAmount(transaction), false, true) }}
    </div>
    <div class="basis-0 flex items-center">
      <button
        type="button"
        class="cursor-pointer"
        [title]="statusIconTitle()"
        [disabled]="!canToggleStatus()"
        (click)="onStatusToggle()"
      >
        <fa-icon [icon]="icCircle" class="w-4 h-4 mx-2" [ngClass]="statusIconClass()"></fa-icon>
      </button>
    </div>
    <div class="basis-3/12 md:basis-2/12 flex items-center justify-end px-1 text-right"
      [class]="getAmountClass(transaction.balance)">
      {{ formatCurrencyWithSign(transaction.balance) }}
    </div>
  </ng-container>

  <!-- Edit mode -->
  <ng-container *ngIf="editing && editModel as model">
    <div class="basis-6/12 md:basis-2/12 flex items-center px-1">
      <app-date-picker class="w-full text-xs" [(ngModel)]="model.date"></app-date-picker>
    </div>
    <div class="basis-3/12 md:basis-2/12 flex items-center px-1">
      <ng-select
        class="w-full text-xs transaction-select"
        [items]="labels"
        [(ngModel)]="model.label"
        [disabled]="transaction.transactionType === 'INITIAL'"
        [clearable]="false"
        [searchable]="true"
        [addTag]="true"
        dropdownPosition="bottom"
      ></ng-select>
    </div>
    <div class="hidden basis-3/12 md:basis-2/12 md:flex items-center px-1">
      <ng-select
        class="w-full text-xs transaction-select"
        [items]="categoryOptions()"
        bindLabel="name"
        bindValue="id"
        [(ngModel)]="model.categoryId"
        [disabled]="transaction.transactionType === 'INITIAL'"
        [clearable]="true"
        [searchable]="true"
        dropdownPosition="bottom"
      ></ng-select>
    </div>
    <div class="hidden basis-3/12 md:basis-2/12 md:flex items-center justify-end px-1 text-right">
      <input class="w-full text-xs p-1 text-right border rounded" type="number" step="0.01"
        [(ngModel)]="model.debit">
    </div>
    <div class="hidden basis-3/12 md:basis-2/12 md:flex items-center justify-end px-1 text-right">
      <input class="w-full text-xs p-1 text-right border rounded" type="number" step="0.01"
        [(ngModel)]="model.credit">
    </div>
        <div class="basis-0 flex items-center">
      <fa-icon [icon]="icCircle" class="w-4 h-4 mx-2 text-gray-300"></fa-icon>
    </div>
    <!-- last visible column reserved for action buttons in edit mode -->
    <div class="basis-3/12 md:basis-2/12 flex items-center justify-end px-1 text-right">
      <div class="flex items-center">
        <button title="Sauvegarder" aria-label="Sauvegarder" class="p-1 bg-blue-500 text-white rounded cursor-pointer"
          (click)="onSave()">
          <fa-icon [icon]="icSave" class="w-4 h-4"></fa-icon>
        </button>
        <button title="Annuler" aria-label="Annuler" class="p-1 ml-0.5 bg-gray-200 rounded cursor-pointer"
          (click)="onCancel()">
          <fa-icon [icon]="icTimes" class="w-4 h-4"></fa-icon>
        </button>
      </div>
    </div>
  </ng-container>
</div>
